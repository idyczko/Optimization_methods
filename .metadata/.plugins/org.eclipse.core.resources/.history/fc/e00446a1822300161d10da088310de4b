/*********************************************
 * OPL 12.6.1.0 Model
 * Author: Igor Dyczko
 * Creation Date: 24-05-2016 at 22:12:01
 *********************************************/
//Constraint Programming
using CP;
//Iloœæ typów odnawialnych zasobów: 
int p = ...;
//Iloœæ czynnoœci
int n = ...;
//Zbiór typów odnawialnych zasobów
range R = 1..p;
//Zbiór czynnoœci
range Z = 1..n;
//Ograniczenia iloœciowe na wykorzystywane w jednym czasie zasoby
int N[R] = ...;
//Czasy wykonania poszczególnych zadañ
int t[Z] = ...;
//Zapotrzebowanie zadañ na zasoby
int r[Z][R] = ...;
//Ograniczenia dotycz¹ce poprzedzania poszczególnych zadañ
{int} c[Z]=...;

//Zmienna decyzyjna - interwa³y czasowe poszczególnych zadañ
dvar interval task[i in Z] size t[i];
//Wyra¿enie oznaczaj¹ce czas dostarczenia ostatniego zadania
dexpr int makespan = max (i in Z) endOf(task[i]);
//Funkcja celu - minimalizacja dostarczenia ostatniego zadania
minimize makespan;

//Ograniczenia:
subject to {
//Ograniczenia wymuszaj¹ce poprzedzanie zadañ
  forall(i in Z, j in c[i])
      endBeforeStart(task[j],task[i]);
//Ograniczenia dotycz¹ce zarz¹dzania zasobami
  forall(i in R)
		sum (j in Z) pulse(task[j],r[j][i])<=N[i];
}
int start[i in Z] = startOf(task[i]);
execute Gannt{
   writeln();
   writeln();
   for(var i in start)
   	for(var j in start[i])
   		write(" ");
   	for(var j in t[i])
};